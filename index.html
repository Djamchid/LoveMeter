<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoveMeter - Suivi de la dynamique de couple</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>üå∏ LoveMeter</h1>
            <p class="subtitle">Suivi de la dynamique de couple</p>
        </header>

        <!-- Navigation -->
        <nav class="app-nav">
            <button class="nav-btn active" data-view="dashboard">Dashboard</button>
            <button class="nav-btn" data-view="actions">Saisie</button>
            <button class="nav-btn" data-view="settings">Param√©trage</button>
            <button class="nav-btn" data-view="guide">Mode d'emploi</button>
        </nav>

        <!-- Main Content Area -->
        <main class="app-content">
            <!-- Dashboard View -->
            <section id="dashboard-view" class="view active">
                <h2>Tableau de Bord</h2>

                <!-- Partners Overview -->
                <div class="partners-overview">
                    <div class="partner-card" id="partner1-card">
                        <div class="partner-header">
                            <div class="partner-color-indicator"></div>
                            <h3 class="partner-name">Partenaire 1</h3>
                        </div>
                        <div class="flower-count">
                            <span class="flower-label">Fleurs:</span>
                            <span class="flower-value">0</span>
                        </div>
                        <div class="alert-indicator"></div>
                    </div>

                    <div class="partner-card" id="partner2-card">
                        <div class="partner-header">
                            <div class="partner-color-indicator"></div>
                            <h3 class="partner-name">Partenaire 2</h3>
                        </div>
                        <div class="flower-count">
                            <span class="flower-label">Fleurs:</span>
                            <span class="flower-value">0</span>
                        </div>
                        <div class="alert-indicator"></div>
                    </div>
                </div>

                <!-- Indicators -->
                <div class="indicators">
                    <div class="indicator-card weather-indicator">
                        <h4>M√©t√©o du couple</h4>
                        <div class="indicator-value" id="weather-value">Variable</div>
                    </div>
                </div>

                <!-- History -->
                <div class="history-section">
                    <div class="section-header">
                        <h3>Historique</h3>
                        <div class="history-actions">
                            <button class="btn btn-secondary" id="export-history-btn">Exporter (CSV)</button>
                            <button class="btn btn-secondary" id="import-history-btn">Importer (CSV)</button>
                            <input type="file" id="import-history-file" accept=".csv" style="display:none;">
                        </div>
                    </div>
                    <div class="history-table-container">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>Date/Heure</th>
                                    <th>Action</th>
                                    <th>Effet Acteur</th>
                                    <th>Effet Partenaire</th>
                                    <th>Total Acteur</th>
                                    <th>Total Partenaire</th>
                                    <th>Note</th>
                                </tr>
                            </thead>
                            <tbody id="history-tbody">
                                <tr class="empty-state">
                                    <td colspan="7">Aucune action enregistr√©e</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Actions View -->
            <section id="actions-view" class="view">
                <h2>Saisie d'Actions</h2>

                <!-- Filter and Sort Controls -->
                <div class="actions-controls">
                    <input type="text" id="action-filter" class="filter-input" placeholder="Filtrer par nom, type ou tags...">
                    <select id="action-sort" class="sort-select">
                        <option value="frequency">Trier par fr√©quence</option>
                        <option value="recent">Trier par dernier usage</option>
                        <option value="name">Trier par nom</option>
                        <option value="impact">Trier par impact total</option>
                    </select>
                </div>

                <!-- Actions List -->
                <div class="actions-list" id="actions-list">
                    <div class="empty-state">
                        <p>Aucune action configur√©e. Allez dans Param√©trage pour cr√©er des actions.</p>
                    </div>
                </div>
            </section>

            <!-- Settings View -->
            <section id="settings-view" class="view">
                <h2>Param√©trage</h2>

                <!-- Partner Configuration -->
                <div class="settings-section">
                    <h3>Partenaires</h3>
                    <div class="partner-config-grid">
                        <div class="partner-config">
                            <h4>Partenaire 1</h4>
                            <div class="form-group">
                                <label>Pr√©nom</label>
                                <input type="text" id="partner1-name" placeholder="Partenaire 1">
                            </div>
                            <div class="form-group">
                                <label>Couleur</label>
                                <input type="color" id="partner1-color" value="#4CAF50">
                            </div>
                        </div>

                        <div class="partner-config">
                            <h4>Partenaire 2</h4>
                            <div class="form-group">
                                <label>Pr√©nom</label>
                                <input type="text" id="partner2-name" placeholder="Partenaire 2">
                            </div>
                            <div class="form-group">
                                <label>Couleur</label>
                                <input type="color" id="partner2-color" value="#2196F3">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Initial Flowers -->
                <div class="settings-section">
                    <h3>Fleurs Initiales</h3>
                    <div class="form-group">
                        <label>Nombre de fleurs initiales (commun aux deux partenaires)</label>
                        <input type="number" id="initial-flowers" value="0" min="-999" max="999">
                        <button class="btn btn-primary" id="apply-initial-flowers">Appliquer aux deux partenaires</button>
                        <p class="warning-text">‚ö†Ô∏è Cela r√©initialisera les fleurs actuelles, l'historique et les statistiques d'usage des actions.</p>
                    </div>
                </div>

                <!-- Alert Thresholds -->
                <div class="settings-section">
                    <h3>Seuils d'Alerte</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Alerte 1 (mod√©r√©e)</label>
                            <input type="number" id="alert1" value="-10">
                        </div>
                        <div class="form-group">
                            <label>Alerte 2 (forte)</label>
                            <input type="number" id="alert2" value="-20">
                        </div>
                    </div>
                </div>

                <!-- Default Sort Mode -->
                <div class="settings-section">
                    <h3>Tri par D√©faut</h3>
                    <div class="form-group">
                        <label>Mode de tri des actions</label>
                        <select id="default-sort">
                            <option value="frequency">Par fr√©quence d'usage</option>
                            <option value="recent">Par dernier usage</option>
                            <option value="name">Par nom</option>
                            <option value="impact">Par impact total</option>
                        </select>
                    </div>
                </div>

                <!-- Actions Management -->
                <div class="settings-section">
                    <div class="section-header">
                        <h3>Gestion des Actions</h3>
                        <button class="btn btn-primary" id="add-action-btn">+ Nouvelle Action</button>
                    </div>

                    <!-- Action Form -->
                    <div class="action-form" id="action-form" style="display:none;">
                        <h4 id="action-form-title">Nouvelle Action</h4>
                        <input type="hidden" id="action-form-id">

                        <div class="form-group">
                            <label>Nom *</label>
                            <input type="text" id="action-name" required>
                        </div>

                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="action-description" rows="3"></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Type</label>
                                <input type="text" id="action-type" placeholder="ex: r√©paration, escalade">
                            </div>
                            <div class="form-group">
                                <label>Tags (s√©par√©s par des virgules)</label>
                                <input type="text" id="action-tags" placeholder="ex: communication, conflit">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Impact Acteur</label>
                                <input type="number" id="action-impact-acteur" value="0">
                            </div>
                            <div class="form-group">
                                <label>Impact Partenaire</label>
                                <input type="number" id="action-impact-partenaire" value="0">
                            </div>
                        </div>

                        <div class="form-actions">
                            <button class="btn btn-primary" id="save-action-btn">Enregistrer</button>
                            <button class="btn btn-secondary" id="cancel-action-btn">Annuler</button>
                        </div>
                    </div>

                    <!-- Actions List in Settings -->
                    <div class="settings-actions-list" id="settings-actions-list">
                        <div class="empty-state">
                            <p>Aucune action configur√©e. Cliquez sur "Nouvelle Action" pour commencer.</p>
                        </div>
                    </div>

                    <!-- CSV Export/Import for Actions -->
                    <div class="csv-actions">
                        <button class="btn btn-secondary" id="export-actions-btn">Exporter Actions (CSV)</button>
                        <button class="btn btn-secondary" id="import-actions-btn">Importer Actions (CSV)</button>
                        <input type="file" id="import-actions-file" accept=".csv" style="display:none;">
                    </div>
                </div>
            </section>

            <!-- Guide View -->
            <section id="guide-view" class="view">
                <h2>Mode d'emploi</h2>

                <div class="guide-section">
                    <h3>üå∏ Pourquoi LoveMeter ?</h3>
                    <p>LoveMeter est un outil qui mesure <strong>l'impact des actions affectives</strong> entre deux partenaires.</p>
                    <ul>
                        <li>Il mesure les <strong>gestes</strong>, pas les personnes</li>
                        <li>Il rend visibles les <strong>dynamiques</strong> relationnelles</li>
                        <li>C'est un outil de <strong>dialogue</strong> et de d√©briefing</li>
                        <li>Il ne juge pas et ne d√©signe pas de coupable</li>
                    </ul>
                </div>

                <div class="guide-section">
                    <h3>üìä Notion de Œî (delta)</h3>
                    <p>Le <strong>Œî</strong> repr√©sente la <strong>variation du stock de fleurs</strong> √©motionnelles.</p>
                    <p>Chaque action a <strong>deux effets</strong> :</p>
                    <ul>
                        <li><strong>Impact Acteur</strong> : effet sur celui qui agit</li>
                        <li><strong>Impact Partenaire</strong> : effet sur celui qui re√ßoit</li>
                    </ul>
                </div>

                <div class="guide-section">
                    <h3>üí° Exemples</h3>
                    <table class="guide-table">
                        <thead>
                            <tr>
                                <th>Action</th>
                                <th>Impact Acteur</th>
                                <th>Impact Partenaire</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Dire merci</td>
                                <td>+3</td>
                                <td>+3</td>
                            </tr>
                            <tr>
                                <td>Crier</td>
                                <td>-2</td>
                                <td>-4</td>
                            </tr>
                            <tr>
                                <td>√âcoute active</td>
                                <td>+3</td>
                                <td>+3</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="guide-section">
                    <h3>üå∏ √âmojis de fleurs (individuels)</h3>
                    <p>Chaque partenaire a son propre √©tat √©motionnel repr√©sent√© par une fleur :</p>
                    <ul>
                        <li><strong>üå∏ Fleur vive</strong> : score ‚â• 0</li>
                        <li><strong>ü•Ä Fleur fan√©e</strong> : score &lt; 0</li>
                    </ul>
                </div>

                <div class="guide-section">
                    <h3>üå§Ô∏è Ambiance globale (m√©t√©o du couple)</h3>
                    <p>La m√©t√©o du couple est calcul√©e selon la <strong>somme des deux scores</strong> :</p>
                    <p><strong>S = Fleurs P1 + Fleurs P2</strong></p>

                    <h4>Si S ‚â• 0 (ambiance positive) :</h4>
                    <ul>
                        <li><strong>‚õÖ Neutre / stable</strong> : |S| entre 0 et 5</li>
                        <li><strong>üå§Ô∏è √âclaircies</strong> : |S| entre 6 et 14</li>
                        <li><strong>üåû Beau temps</strong> : |S| entre 15 et 29</li>
                        <li><strong>üåû‚ú® Grand soleil</strong> : |S| ‚â• 30</li>
                    </ul>

                    <h4>Si S &lt; 0 (ambiance difficile) :</h4>
                    <ul>
                        <li><strong>üå´Ô∏è Neutre / l√©g√®re tension</strong> : |S| entre 0 et 5</li>
                        <li><strong>üåßÔ∏è Averses √©motionnelles</strong> : |S| entre 6 et 14</li>
                        <li><strong>üåßÔ∏è‚õàÔ∏è Gros temps</strong> : |S| entre 15 et 29</li>
                        <li><strong>‚õàÔ∏è Temp√™te √©motionnelle</strong> : |S| ‚â• 30</li>
                    </ul>
                </div>

                <div class="guide-section">
                    <h3>üéØ Comment utiliser ?</h3>
                    <ol>
                        <li>Configurez vos <strong>pr√©noms et couleurs</strong> dans Param√©trage</li>
                        <li>Dans Saisie, choisissez une action</li>
                        <li>Cliquez sur le bouton correspondant √† <strong>qui agit</strong></li>
                        <li>Consultez le Dashboard pour voir l'√©volution</li>
                        <li>Utilisez l'historique pour d√©briefing et dialogue</li>
                    </ol>
                </div>

                <div class="guide-section">
                    <p class="guide-footer">
                        <em>¬´ Fleurs en plus, blessures en moins. ¬ª</em>
                    </p>
                </div>
            </section>
        </main>
    </div>

    <!-- Load the application as ES6 module -->
    <script type="module" src="js/main.js"></script>
</body>
</html>
